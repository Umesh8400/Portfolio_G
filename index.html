<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Umesh Joshi | Battery Engineer Portfolio</title>
    
    <!-- Leaflet CSS + JS for map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5n/N0ZDv4=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    
    <style>
        :root {
            --primary: #3498db;
            --white: #ffffff;
            --dark: #0f172a;
        }
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', Roboto, sans-serif; }
        body {
            background: var(--dark);
            color: var(--white);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            user-select: none;
        }
        #bg-image {
            position: absolute;
            inset: 0;
            background-size: cover;
            background-position: center;
            z-index: -3;
            opacity: 0.7;
            transition: opacity 1.2s;
        }
        .overlay { 
            position: absolute; inset: 0; 
            background: rgba(15,23,42,0.65); 
            z-index: -2; 
        }
        .screen {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            opacity: 0; pointer-events: none;
            transition: opacity 0.9s ease, transform 0.9s ease;
            transform: translateY(30px);
        }
        .screen.active {
            opacity: 1; pointer-events: all; transform: translateY(0);
        }
        /* Hello screen */
        .hello-cloud { position: relative; width: 90vw; max-width: 900px; height: 50vh; }
        .cloud-word {
            position: absolute; color: rgba(255,255,255,0.85);
            font-weight: bold; animation: float 6s ease-in-out infinite;
        }
        @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
        .w-main { font-size: 6rem; top:50%; left:50%; transform:translate(-50%,-50%); text-shadow:0 0 30px #3498db; }
        .welcome-line { margin-top: 2.5rem; font-size: 1.8rem; letter-spacing: 6px; text-transform: uppercase; }

        /* Map screen */
        #map-container {
            width: 90vw; max-width: 1100px; height: 70vh;
            border-radius: 16px; overflow: hidden;
            box-shadow: 0 0 40px rgba(52,152,219,0.4);
            background: #111827;
        }
        #experience-map { height: 100%; }
        .info-box {
            position: absolute; bottom: 20px; left: 20px; right: 20px;
            background: rgba(30,41,59,0.92); backdrop-filter: blur(8px);
            padding: 20px; border-radius: 12px;
            max-height: 280px; overflow-y: auto;
            border: 1px solid var(--primary); display: none;
            animation: fadeUp 0.6s;
        }
        @keyframes fadeUp { from { opacity:0; transform:translateY(30px); } to { opacity:1; transform:translateY(0); } }
        .car-path { 
            position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1000;
        }
        .car-svg { width:60px; fill:#e63946; filter: drop-shadow(0 0 10px #e63946); }

        /* Navigation */
        .nav-ui {
            position: absolute; bottom: 25px; width: 100%;
            display: flex; justify-content: space-between; padding: 0 50px;
            z-index: 200;
        }
        .nav-btn {
            font-size: 1.3rem; font-weight: bold; cursor: pointer;
            color: white; opacity: 0.8; transition: all 0.3s;
        }
        .nav-btn:hover { opacity:1; color: var(--primary); transform: scale(1.08); }

        h1,h2,h3 { text-shadow: 0 2px 10px rgba(0,0,0,0.6); }
        h2 { color: var(--primary); }
    </style>
</head>
<body>

<div id="bg-image"></div>
<div class="overlay"></div>

<div class="click-zone" style="position:absolute; top:0; left:0; width:40%; height:100%; z-index:50;" onclick="goBack()"></div>
<div class="click-zone" style="position:absolute; top:0; right:0; width:40%; height:100%; z-index:50;" onclick="goNext()"></div>

<!-- Hello Screen -->
<div id="screen-hello" class="screen active">
    <div class="hello-cloud">
        <span class="cloud-word w-main" style="animation-delay:0s;">Hello</span>
        <span class="cloud-word" style="top:18%; left:15%; font-size:2rem; animation-delay:0.8s;">Namaskar</span>
        <span class="cloud-word" style="top:22%; right:18%; font-size:2.4rem; animation-delay:1.4s;">Hallo</span>
        <!-- more greetings if you want -->
    </div>
    <div class="welcome-line">Umesh Joshi ‚Äì Battery Engineer Portfolio</div>
    <div class="nav-ui" style="justify-content:flex-end;">
        <div class="nav-btn" onclick="goToLanguages()">START ‚Üí</div>
    </div>
</div>

<!-- Language Selection -->
<div id="screen-lang" class="screen">
    <h1 style="font-size:3.5rem; margin-bottom:2rem;">Select Language</h1>
    <button class="nav-btn" style="font-size:2rem; padding:15px 60px; margin:20px;" onclick="selectLang('en')">English</button>
    <button class="nav-btn" style="font-size:2rem; padding:15px 60px; margin:20px;" onclick="selectLang('de')">Deutsch</button>
</div>

<!-- Main Content Screen -->
<div id="screen-content" class="screen"></div>

<!-- Global Navigation -->
<div id="global-nav" class="nav-ui" style="display:none;">
    <div class="nav-btn" onclick="goBack()">‚Üê BACK</div>
    <div class="nav-btn" onclick="goNext()">NEXT ‚Üí</div>
</div>

<script>
// --------------------- DATA ---------------------
const data = {
    en: [
        { type:"intro", title:"Umesh Yadneshwar Joshi", subtitle:"Battery Development Engineer | M.Eng. Renewable Energies & E-Mobility", text:"Specialized in Lithium-Ion Battery Modeling, Algorithms, HV Systems & Validation" },
        { type:"title", title:"PROFESSIONAL EXPERIENCE" },
        { type:"map" },  // ‚Üê this is the new animated map slide
        { type:"title", title:"EDUCATION" },
        // ... you can continue adding education, projects, skills, etc. as before
        { type:"end", title:"Thank You", subtitle:"Let's connect", links:true }
    ],
    de: [
        { type:"intro", title:"Umesh Yadneshwar Joshi", subtitle:"Batterieentwicklungsingenieur | M.Eng. Erneuerbare Energien & E-Mobilit√§t", text:"Spezialisiert auf Lithium-Ionen-Batteriemodellierung, Algorithmen, Hochvoltsysteme & Validierung" },
        { type:"title", title:"BERUFSERFAHRUNG" },
        { type:"map" },
        { type:"title", title:"AUSBILDUNG" },
        { type:"end", title:"Vielen Dank", subtitle:"Lassen Sie uns in Kontakt treten", links:true }
    ]
};

// Experience data for map (used in both languages)
const experiences = [
    {
        id: "elring-intern",
        title_en: "Intern ‚Äì Battery System Tests & Validation",
        title_de: "Praktikant ‚Äì Batterie-Systemtests & Validierung",
        date: "05.2023 ‚Äì 11.2023",
        location: [48.558, 9.378], // Neuffen approx
        details_en: "‚Ä¢ Tests & validation of battery systems, ECUs and drives<br>‚Ä¢ Impedance measurements on aluminum foils & battery<br>‚Ä¢ Test protocol creation & documentation",
        details_de: "‚Ä¢ Tests & Validierung von Batteriesystemen, ECUs & Antrieben<br>‚Ä¢ Impedanzmessungen an Aluminiumfolien & Batterie<br>‚Ä¢ Erstellung von Testprotokollen & Dokumentation"
    },
    {
        id: "elring-ws",
        title_en: "Working Student ‚Äì Battery Development",
        title_de: "Werkstudent ‚Äì Batterieentwicklung",
        date: "11.2023 ‚Äì 01.2024",
        location: [48.558, 9.378],
        details_en: "‚Ä¢ Testing battery components & cells + test case creation<br>‚Ä¢ Evaluation with X-Frame & DIAdem<br>‚Ä¢ Hardware design support for ECUs & microcontrollers",
        details_de: "‚Ä¢ Testen von Batteriekomponenten & -zellen + Testfallerstellung<br>‚Ä¢ Auswertung mit X-Frame & DIAdem<br>‚Ä¢ Mitarbeit am Hardware-Design von ECUs & Mikrocontrollern"
    },
    {
        id: "mb-ws1",
        title_en: "Working Student ‚Äì HV Battery System Pre-Development",
        title_de: "Werkstudent ‚Äì Hochvolt Batterieentwicklung (System Vorentwicklung)",
        date: "02.2024 ‚Äì 11.2024",
        location: [48.775, 9.180], // Stuttgart approx
        details_en: "‚Ä¢ MATLAB automation scripts ‚Üí 95‚Äì98% workload reduction<br>‚Ä¢ 3D simulation models in CST Studio Suite<br>‚Ä¢ Impedance measurements & magnetometer manuals",
        details_de: "‚Ä¢ MATLAB-Skripte zur Automatisierung ‚Üí 95‚Äì98% Aufwandsreduktion<br>‚Ä¢ 3D-Simulationsmodelle in CST Studio Suite<br>‚Ä¢ Impedanzmessungen & Bedienungsanleitungen"
    },
    {
        id: "mb-thesis",
        title_en: "Master Thesis ‚Äì Voltage Relaxation Modeling (1.0)",
        title_de: "Masterarbeit ‚Äì Spannungsrelaxationsmodellierung (1.0)",
        date: "12.2024 ‚Äì 07.2025",
        location: [48.775, 9.180],
        details_en: "‚Ä¢ Advanced relaxation model in Python<br>‚Ä¢ Adaptive optimization ‚Üí 80‚Äì85% accuracy improvement<br>‚Ä¢ CyIPOPT gradient method<br>‚Ä¢ Significant SOC estimation enhancement",
        details_de: "‚Ä¢ Fortgeschrittenes Relaxationsmodell in Python<br>‚Ä¢ Adaptiver Optimierungsalgorithmus ‚Üí 80‚Äì85% Genauigkeitssteigerung<br>‚Ä¢ CyIPOPT Gradientenmethode<br>‚Ä¢ Deutliche Verbesserung der SOC-Sch√§tzung"
    },
    {
        id: "mb-ws2",
        title_en: "Working Student ‚Äì Battery Algorithms & Applications",
        title_de: "Werkstudent ‚Äì Batterieentwicklung, Algorithmen & Applikationen",
        date: "08.2025 ‚Äì Present",
        location: [48.775, 9.180],
        details_en: "‚Ä¢ Research on voltage relaxation ML framework<br>‚Ä¢ Anomaly dataset & structured data catalog creation<br>‚Ä¢ Preparation for supervised ML model training",
        details_de: "‚Ä¢ Forschung zu ML-Rahmen f√ºr Spannungsrelaxation<br>‚Ä¢ Erstellung Anomalie-Datensatz & Datenkatalog<br>‚Ä¢ Vorbereitung f√ºr √ºberwachtes ML-Training"
    }
];

// State
let currentLang = 'en';
let slideIndex = 0;
let appState = 'hello';

// DOM
const screenHello   = document.getElementById('screen-hello');
const screenLang    = document.getElementById('screen-lang');
const screenContent = document.getElementById('screen-content');
const globalNav     = document.getElementById('global-nav');
const bgDiv         = document.getElementById('bg-image');

let map = null;
let currentOpen = null;

// --------------------- FUNCTIONS ---------------------
function init() {
    bgDiv.style.backgroundImage = "url('https://images.unsplash.com/photo-1503387762-592deb58caa5?auto=format&fit=crop&q=80')";
}

function goToLanguages() {
    appState = 'lang';
    switchScreen(screenHello, screenLang);
}

function selectLang(lang) {
    currentLang = lang;
    appState = 'content';
    slideIndex = 0;
    renderSlide();
    switchScreen(screenLang, screenContent);
    globalNav.style.display = 'flex';
}

function goNext() {
    if (appState === 'hello') return goToLanguages();
    if (appState !== 'content') return;
    
    if (slideIndex < data[currentLang].length - 1) {
        slideIndex++;
        renderSlide();
    } else {
        slideIndex = 0; // loop
        renderSlide();
    }
}

function goBack() {
    if (appState !== 'content') return;
    if (slideIndex > 0) {
        slideIndex--;
        renderSlide();
    } else {
        slideIndex = data[currentLang].length - 1;
        renderSlide();
    }
}

function switchScreen(from, to) {
    from.classList.remove('active');
    setTimeout(() => to.classList.add('active'), 800);
}

function renderSlide() {
    screenContent.classList.remove('active');
    setTimeout(() => {
        const slide = data[currentLang][slideIndex];
        let html = '';

        if (slide.type === 'intro') {
            html = `
                <h1 style="font-size:4.5rem;">${slide.title}</h1>
                <h2 style="font-size:2.2rem; margin:1rem 0;">${slide.subtitle}</h2>
                <p style="font-size:1.4rem; max-width:800px; text-align:center;">${slide.text}</p>
            `;
        } else if (slide.type === 'title') {
            html = `<h1 style="font-size:6rem; letter-spacing:8px; text-transform:uppercase;">${slide.title}</h1>`;
        } else if (slide.type === 'map') {
            html = `
                <h2 style="margin-bottom:1.5rem; font-size:2.8rem;">${currentLang==='en'?'Professional Journey in Germany':'Beruflicher Werdegang in Deutschland'}</h2>
                <div id="map-container">
                    <div id="experience-map"></div>
                    <svg class="car-path" id="car-path" viewBox="0 0 1000 600"></svg>
                </div>
                <div class="info-box" id="info-box">
                    <h3 id="info-title"></h3>
                    <p id="info-date" style="color:#94a3b8;"></p>
                    <div id="info-details"></div>
                </div>
            `;
        } else if (slide.type === 'end') {
            html = `
                <h1 style="font-size:5rem;">${slide.title}</h1>
                <h3 style="margin:1.5rem 0;">${slide.subtitle}</h3>
                <div style="margin-top:2rem;">
                    <a href="mailto:studentumeshjoshi@gmail.com" style="margin:0 15px; color:var(--primary); font-size:1.4rem; text-decoration:none;">Email</a>
                    <a href="https://linkedin.com" target="_blank" style="margin:0 15px; color:var(--primary); font-size:1.4rem; text-decoration:none;">LinkedIn</a>
                    <a href="https://xing.com" target="_blank" style="margin:0 15px; color:var(--primary); font-size:1.4rem; text-decoration:none;">XING</a>
                </div>
            `;
        }

        screenContent.innerHTML = html;
        screenContent.classList.add('active');

        // Initialize map after it's in DOM
        if (slide.type === 'map') {
            setTimeout(initExperienceMap, 400);
        }
    }, 700);
}

function initExperienceMap() {
    if (map) map.remove();
    
    map = L.map('experience-map', {
        zoomControl: false,
        attributionControl: false
    }).setView([51.0, 10.0], 6); // center Germany

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        subdomains: 'abcd',
        maxZoom: 19
    }).addTo(map);

    // Add markers
    experiences.forEach((exp, i) => {
        const marker = L.marker(exp.location, {
            icon: L.divIcon({
                className: 'custom-marker',
                html: `<div style="background:var(--primary);width:18px;height:18px;border-radius:50%;border:3px solid white;cursor:pointer;" data-id="${exp.id}"></div>`,
                iconSize: [18,18],
                iconAnchor: [9,9]
            })
        }).addTo(map);

        marker.on('click', () => showExperience(exp.id));
    });

    // Start sequence animation
    gsap.timeline()
        .to(map, {duration:1.8, ease:"power2.inOut"}, "start")
        .call(() => map.flyTo(experiences[0].location, 12, {duration:2.2}), null, "start+=0.4")
        .call(() => showExperience("elring-intern"), null, "start+=2.8")
        .call(drawCarPath, null, "start+=4.5");
}

function showExperience(id) {
    if (currentOpen === id) {
        document.getElementById('info-box').style.display = 'none';
        currentOpen = null;
        return;
    }

    const exp = experiences.find(e => e.id === id);
    if (!exp) return;

    document.getElementById('info-title').textContent = currentLang==='en' ? exp.title_en : exp.title_de;
    document.getElementById('info-date').textContent = exp.date;
    document.getElementById('info-details').innerHTML = currentLang==='en' ? exp.details_en : exp.details_de;

    document.getElementById('info-box').style.display = 'block';
    currentOpen = id;
}

function drawCarPath() {
    const path = document.getElementById('car-path');
    const line = document.createElementNS("http://www.w3.org/2000/svg", "path");
    line.setAttribute("d", "M 200 300 Q 400 180, 600 320 Q 750 420, 850 280"); // rough path Neuffen ‚Üí Stuttgart
    line.setAttribute("stroke", "#e63946");
    line.setAttribute("stroke-width", "4");
    line.setAttribute("fill", "none");
    line.setAttribute("stroke-dasharray", "1000");
    line.setAttribute("stroke-dashoffset", "1000");
    path.appendChild(line);

    const car = document.createElementNS("http://www.w3.org/2000/svg", "g");
    car.innerHTML = `<text x="0" y="0" font-size="40" class="car-svg">üöó</text>`;
    path.appendChild(car);

    gsap.to(line, {
        strokeDashoffset: 0,
        duration: 4,
        ease: "power1.inOut",
        onUpdate: function() {
            const len = line.getTotalLength();
            const p = line.getPointAtLength(len * this.progress());
            gsap.set(car, {x: p.x - 30, y: p.y - 30});
        }
    });
}

// Keyboard
document.addEventListener('keydown', e => {
    if (e.key === 'ArrowRight') goNext();
    if (e.key === 'ArrowLeft') goBack();
});

init();
</script>
</body>
</html>
